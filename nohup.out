[32m[2019-03-14 21:01:17 @__init__.py:79][0m Set root logger. Unset logger with neuralgym.unset_logger().
[32m[2019-03-14 21:01:17 @__init__.py:80][0m Saving logging to file: neuralgym_logs/20190314210117112192.
[32m[2019-03-14 21:01:25 @config.py:92][0m ---------------------------------- APP CONFIG ----------------------------------
[32m[2019-03-14 21:01:25 @config.py:119][0m TV_LOSS: False
[32m[2019-03-14 21:01:25 @config.py:119][0m MAX_DELTA_WIDTH: 32
[32m[2019-03-14 21:01:25 @config.py:119][0m VIZ_MAX_OUT: 10
[32m[2019-03-14 21:01:25 @config.py:119][0m VAL_PSTEPS: 1000
[32m[2019-03-14 21:01:25 @config.py:119][0m L1_LOSS: True
[32m[2019-03-14 21:01:25 @config.py:119][0m BATCH_SIZE: 16
[32m[2019-03-14 21:01:25 @config.py:119][0m GPU_ID: -1
[32m[2019-03-14 21:01:25 @config.py:119][0m MAX_DELTA_HEIGHT: 32
[32m[2019-03-14 21:01:25 @config.py:119][0m IMG_SHAPES: [256, 256, 3]
[32m[2019-03-14 21:01:25 @config.py:119][0m COARSE_L1_ALPHA: 1.2
[32m[2019-03-14 21:01:25 @config.py:119][0m RANDOM_CROP: False
[32m[2019-03-14 21:01:25 @config.py:119][0m VAL: False
[32m[2019-03-14 21:01:25 @config.py:119][0m VERTICAL_MARGIN: 0
[32m[2019-03-14 21:01:25 @config.py:119][0m GAN_LOSS_ALPHA: 0.001
[32m[2019-03-14 21:01:25 @config.py:119][0m MODEL_RESTORE: release_imagenet_256
[32m[2019-03-14 21:01:25 @config.py:119][0m GLOBAL_DCGAN_LOSS_ALPHA: 1.0
[32m[2019-03-14 21:01:25 @config.py:119][0m AE_LOSS_ALPHA: 1.2
[32m[2019-03-14 21:01:25 @config.py:119][0m STATIC_VIEW_SIZE: 30
[32m[2019-03-14 21:01:25 @config.py:119][0m WGAN_GP_LAMBDA: 10
[32m[2019-03-14 21:01:25 @config.py:119][0m GRADS_SUMMARY: False
[32m[2019-03-14 21:01:25 @config.py:119][0m TRAIN_SPE: 1000
[32m[2019-03-14 21:01:25 @config.py:119][0m GRADIENT_CLIP_VALUE: 0.1Â Â 
[32m[2019-03-14 21:01:25 @config.py:119][0m HORIZONTAL_MARGIN: 0
[32m[2019-03-14 21:01:25 @config.py:111][0m DATA_FLIST: 
[32m[2019-03-14 21:01:25 @config.py:119][0m   celebahq: ['data/celeba_hq/train_shuffled.flist', 'data/celeba_hq/validation_static_view.flist']
[32m[2019-03-14 21:01:25 @config.py:119][0m   places2: ['data/places2/train_shuffled.flist', 'data/places2/validation_static_view.flist']
[32m[2019-03-14 21:01:25 @config.py:119][0m   imagenet: ['data/imagenet/train_shuffled.flist', 'data/imagenet/validation_static_view.flist']
[32m[2019-03-14 21:01:25 @config.py:119][0m   celeba: ['data/celeba/train_shuffled.flist', 'data/celeba/validation_static_view.flist']
[32m[2019-03-14 21:01:25 @config.py:119][0m   mine: ['data_flist/train_shuffled.flist', 'data_flist/validation_shuffled.flist']
[32m[2019-03-14 21:01:25 @config.py:119][0m PADDING: SAME
[32m[2019-03-14 21:01:25 @config.py:119][0m HEIGHT: 128
[32m[2019-03-14 21:01:25 @config.py:119][0m GAN: wgan_gp
[32m[2019-03-14 21:01:25 @config.py:119][0m TV_LOSS_ALPHA: 0.0
[32m[2019-03-14 21:01:25 @config.py:119][0m DISCOUNTED_MASK: True
[32m[2019-03-14 21:01:25 @config.py:119][0m LOG_DIR: full_model_celeba_hq_256
[32m[2019-03-14 21:01:25 @config.py:119][0m FEATURE_LOSS: False
[32m[2019-03-14 21:01:25 @config.py:119][0m GRAMS_LOSS: False
[32m[2019-03-14 21:01:25 @config.py:119][0m GRADIENT_CLIP: False
[32m[2019-03-14 21:01:25 @config.py:119][0m NUM_GPUS: 1
[32m[2019-03-14 21:01:25 @config.py:119][0m DATASET: mine
[32m[2019-03-14 21:01:25 @config.py:119][0m VGG_MODEL_FILE: data/model_zoo/vgg16.npz
[32m[2019-03-14 21:01:25 @config.py:119][0m RANDOM_SEED: False
[32m[2019-03-14 21:01:25 @config.py:119][0m FEATURE_LOSS_ALPHA: 0.01
[32m[2019-03-14 21:01:25 @config.py:119][0m GLOBAL_WGAN_LOSS_ALPHA: 1.0
[32m[2019-03-14 21:01:25 @config.py:119][0m SPATIAL_DISCOUNTING_GAMMA: 0.9
[32m[2019-03-14 21:01:25 @config.py:119][0m WIDTH: 128
[32m[2019-03-14 21:01:25 @config.py:119][0m LOAD_VGG_MODEL: False
[32m[2019-03-14 21:01:25 @config.py:119][0m PRETRAIN_COARSE_NETWORK: False
[32m[2019-03-14 21:01:25 @config.py:119][0m GAN_WITH_MASK: False
[32m[2019-03-14 21:01:25 @config.py:119][0m GRAMS_LOSS_ALPHA: 50
[32m[2019-03-14 21:01:25 @config.py:119][0m AE_LOSS: True
[32m[2019-03-14 21:01:25 @config.py:119][0m MAX_ITERS: 10000
[32m[2019-03-14 21:01:25 @config.py:119][0m L1_LOSS_ALPHA: 1.2
[32m[2019-03-14 21:01:25 @config.py:94][0m --------------------------------------------------------------------------------
[32m[2019-03-14 21:01:26 @gpus.py:20][0m Set env: CUDA_VISIBLE_DEVICES=[0].
[32m[2019-03-14 21:01:26 @dataset.py:26][0m --------------------------------- Dataset Info ---------------------------------
[32m[2019-03-14 21:01:26 @dataset.py:36][0m queue_size: 256
[32m[2019-03-14 21:01:26 @dataset.py:36][0m nthreads: 16
[32m[2019-03-14 21:01:26 @dataset.py:36][0m dtypes: [tf.float32]
[32m[2019-03-14 21:01:26 @dataset.py:36][0m index: 0
[32m[2019-03-14 21:01:26 @dataset.py:36][0m batch_phs: [<tf.Tensor 'Placeholder:0' shape=(?, 256, 256, 3) dtype=float32>]
[32m[2019-03-14 21:01:26 @dataset.py:36][0m random_crop: False
[32m[2019-03-14 21:01:26 @dataset.py:36][0m shapes: [[256, 256, 3]]
[32m[2019-03-14 21:01:26 @dataset.py:36][0m file_length: 1065
[32m[2019-03-14 21:01:26 @dataset.py:36][0m filetype: image
[32m[2019-03-14 21:01:26 @dataset.py:36][0m fn_preprocess: None
[32m[2019-03-14 21:01:26 @dataset.py:36][0m enqueue_size: 32
[32m[2019-03-14 21:01:26 @dataset.py:36][0m return_fnames: False
[32m[2019-03-14 21:01:26 @dataset.py:36][0m random: False
[32m[2019-03-14 21:01:26 @dataset.py:37][0m --------------------------------------------------------------------------------
[32m[2019-03-14 21:01:28 @inpaint_model.py:159][0m Set batch_predicted to x2.
[32m[2019-03-14 21:01:28 @inpaint_ops.py:201][0m Use spatial discounting l1 loss.
[32m[2019-03-14 21:01:28 @inpaint_ops.py:201][0m Use spatial discounting l1 loss.
[32m[2019-03-14 21:01:29 @inpaint_model.py:241][0m Set L1_LOSS_ALPHA to 1.200000
[32m[2019-03-14 21:01:29 @inpaint_model.py:242][0m Set GAN_LOSS_ALPHA to 0.001000
[32m[2019-03-14 21:01:29 @inpaint_model.py:245][0m Set AE_LOSS_ALPHA to 1.200000
[32m[2019-03-14 21:01:30 @inpaint_model.py:159][0m Set batch_predicted to x2.
[32m[2019-03-14 21:01:30 @inpaint_ops.py:201][0m Use spatial discounting l1 loss.
[32m[2019-03-14 21:01:30 @inpaint_ops.py:201][0m Use spatial discounting l1 loss.
[32m[2019-03-14 21:01:31 @inpaint_model.py:241][0m Set L1_LOSS_ALPHA to 1.200000
[32m[2019-03-14 21:01:31 @inpaint_model.py:242][0m Set GAN_LOSS_ALPHA to 0.001000
[32m[2019-03-14 21:01:31 @inpaint_model.py:245][0m Set AE_LOSS_ALPHA to 1.200000
[32m[2019-03-14 21:01:32 @trainer.py:61][0m ------------------------- Context Of Secondary Trainer -------------------------
[32m[2019-03-14 21:01:32 @trainer.py:63][0m graph_def: <function multigpu_graph_def at 0x7f7dd3340f28>
[32m[2019-03-14 21:01:32 @trainer.py:63][0m optimizer: <tensorflow.python.training.adam.AdamOptimizer object at 0x7f7d9d321f98>
[32m[2019-03-14 21:01:32 @trainer.py:63][0m log_progress: False
[32m[2019-03-14 21:01:32 @trainer.py:63][0m grads_summary: True
[32m[2019-03-14 21:01:32 @trainer.py:63][0m spe: 1
[32m[2019-03-14 21:01:32 @trainer.py:63][0m feed_dict: {}
[32m[2019-03-14 21:01:32 @trainer.py:63][0m graph_def_kwargs: {'loss_type': 'd', 'model': <inpaint_model.InpaintCAModel object at 0x7f7d9e16af60>, 'data': <neuralgym.data.data_from_fnames.DataFromFNames object at 0x7f7d9e1b1320>, 'config': {}}
[32m[2019-03-14 21:01:32 @trainer.py:63][0m max_iters: 5
[32m[2019-03-14 21:01:32 @trainer.py:63][0m var_list: [<tf.Variable 'discriminator/discriminator_local/conv1/kernel:0' shape=(5, 5, 3, 64) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv1/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv2/kernel:0' shape=(5, 5, 64, 128) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv2/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv3/kernel:0' shape=(5, 5, 128, 256) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv3/bias:0' shape=(256,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv4/kernel:0' shape=(5, 5, 256, 512) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_local/conv4/bias:0' shape=(512,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv1/kernel:0' shape=(5, 5, 3, 64) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv1/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv2/kernel:0' shape=(5, 5, 64, 128) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv2/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv3/kernel:0' shape=(5, 5, 128, 256) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv3/bias:0' shape=(256,) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv4/kernel:0' shape=(5, 5, 256, 256) dtype=float32_ref>, <tf.Variable 'discriminator/discriminator_global/conv4/bias:0' shape=(256,) dtype=float32_ref>, <tf.Variable 'discriminator/dout_local_fc/kernel:0' shape=(32768, 1) dtype=float32_ref>, <tf.Variable 'discriminator/dout_local_fc/bias:0' shape=(1,) dtype=float32_ref>, <tf.Variable 'discriminator/dout_global_fc/kernel:0' shape=(65536, 1) dtype=float32_ref>, <tf.Variable 'discriminator/dout_global_fc/bias:0' shape=(1,) dtype=float32_ref>]
[32m[2019-03-14 21:01:32 @trainer.py:63][0m log_dir: /tmp/neuralgym
[32m[2019-03-14 21:01:32 @trainer.py:64][0m --------------------------------------------------------------------------------
[32m[2019-03-14 21:01:34 @inpaint_model.py:159][0m Set batch_predicted to x2.
[32m[2019-03-14 21:01:34 @inpaint_ops.py:201][0m Use spatial discounting l1 loss.
[32m[2019-03-14 21:01:34 @inpaint_ops.py:201][0m Use spatial discounting l1 loss.
[32m[2019-03-14 21:01:40 @inpaint_model.py:241][0m Set L1_LOSS_ALPHA to 1.200000
[32m[2019-03-14 21:01:40 @inpaint_model.py:242][0m Set GAN_LOSS_ALPHA to 0.001000
[32m[2019-03-14 21:01:40 @inpaint_model.py:245][0m Set AE_LOSS_ALPHA to 1.200000
2019-03-14 21:01:44.002212: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
[32m[2019-03-14 21:01:48 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
[32m[2019-03-14 21:01:48 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
Exception in thread Thread-17:
Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/feeding_queue_runner.py", line 194, in _run
    data = func()
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 143, in <lambda>
    feed_dict_op=[lambda: self.next_batch()],
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 182, in next_batch
    img = cv2.resize(img, tuple(self.shapes[i][:-1][::-1]))
cv2.error: OpenCV(4.0.0) /io/opencv/modules/imgproc/src/resize.cpp:3784: error: (-215:Assertion failed) !ssize.empty() in function 'resize'


Exception in thread Thread-14:
Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/feeding_queue_runner.py", line 194, in _run
    data = func()
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 143, in <lambda>
    feed_dict_op=[lambda: self.next_batch()],
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 182, in next_batch
    img = cv2.resize(img, tuple(self.shapes[i][:-1][::-1]))
cv2.error: OpenCV(4.0.0) /io/opencv/modules/imgproc/src/resize.cpp:3784: error: (-215:Assertion failed) !ssize.empty() in function 'resize'


[32m[2019-03-14 21:01:49 @trainer.py:59][0m -------------------------- Context Of Primary Trainer --------------------------
[32m[2019-03-14 21:01:49 @trainer.py:63][0m sess: <tensorflow.python.client.session.Session object at 0x7f7d98eab6a0>
[32m[2019-03-14 21:01:49 @trainer.py:63][0m start_queue_runners: True
[32m[2019-03-14 21:01:49 @trainer.py:63][0m optimizer: <tensorflow.python.training.adam.AdamOptimizer object at 0x7f7d9d321f98>
[32m[2019-03-14 21:01:49 @trainer.py:63][0m saver: <tensorflow.python.training.saver.Saver object at 0x7f7d99a02828>
[32m[2019-03-14 21:01:49 @trainer.py:63][0m gradient_processor: None
[32m[2019-03-14 21:01:49 @trainer.py:63][0m summary_writer: <tensorflow.python.summary.writer.writer.FileWriter object at 0x7f7d99a026d8>
[32m[2019-03-14 21:01:49 @trainer.py:63][0m spe: 1000
[32m[2019-03-14 21:01:49 @trainer.py:63][0m global_step: <tf.Variable 'global_step:0' shape=() dtype=int32_ref>
[32m[2019-03-14 21:01:49 @trainer.py:63][0m sess_config: gpu_options {
  allow_growth: true
}
allow_soft_placement: true

[32m[2019-03-14 21:01:49 @trainer.py:63][0m max_iters: 10000
[32m[2019-03-14 21:01:49 @trainer.py:63][0m graph_def: <function multigpu_graph_def at 0x7f7dd3340f28>
[32m[2019-03-14 21:01:49 @trainer.py:63][0m feed_dict: {}
[32m[2019-03-14 21:01:49 @trainer.py:63][0m log_progress: True
[32m[2019-03-14 21:01:49 @trainer.py:63][0m grads_summary: False
[32m[2019-03-14 21:01:49 @trainer.py:63][0m global_variables_initializer: True
[32m[2019-03-14 21:01:49 @trainer.py:63][0m graph_def_kwargs: {'loss_type': 'g', 'model': <inpaint_model.InpaintCAModel object at 0x7f7d9e16af60>, 'data': <neuralgym.data.data_from_fnames.DataFromFNames object at 0x7f7d9e1b1320>, 'config': {}}
[32m[2019-03-14 21:01:49 @trainer.py:63][0m var_list: [<tf.Variable 'inpaint_net/conv1/kernel:0' shape=(5, 5, 5, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv1/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv2_downsample/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv2_downsample/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv3/kernel:0' shape=(3, 3, 64, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv3/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv4_downsample/kernel:0' shape=(3, 3, 64, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv4_downsample/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv5/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv5/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv6/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv6/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv7_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv7_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv8_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv8_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv9_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv9_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv10_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv10_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv11/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv11/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv12/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv12/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv13_upsample/conv13_upsample_conv/kernel:0' shape=(3, 3, 128, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv13_upsample/conv13_upsample_conv/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv14/kernel:0' shape=(3, 3, 64, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv14/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv15_upsample/conv15_upsample_conv/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv15_upsample/conv15_upsample_conv/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv16/kernel:0' shape=(3, 3, 32, 16) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv16/bias:0' shape=(16,) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv17/kernel:0' shape=(3, 3, 16, 3) dtype=float32_ref>, <tf.Variable 'inpaint_net/conv17/bias:0' shape=(3,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv1/kernel:0' shape=(5, 5, 5, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv1/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv2_downsample/kernel:0' shape=(3, 3, 32, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv2_downsample/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv3/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv3/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv4_downsample/kernel:0' shape=(3, 3, 64, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv4_downsample/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv5/kernel:0' shape=(3, 3, 64, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv5/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv6/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv6/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv7_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv7_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv8_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv8_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv9_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv9_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv10_atrous/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/xconv10_atrous/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv1/kernel:0' shape=(5, 5, 5, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv1/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv2_downsample/kernel:0' shape=(3, 3, 32, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv2_downsample/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv3/kernel:0' shape=(3, 3, 32, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv3/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv4_downsample/kernel:0' shape=(3, 3, 64, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv4_downsample/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv5/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv5/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv6/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv6/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv9/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv9/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv10/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/pmconv10/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv11/kernel:0' shape=(3, 3, 256, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv11/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv12/kernel:0' shape=(3, 3, 128, 128) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv12/bias:0' shape=(128,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv13_upsample/allconv13_upsample_conv/kernel:0' shape=(3, 3, 128, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv13_upsample/allconv13_upsample_conv/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv14/kernel:0' shape=(3, 3, 64, 64) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv14/bias:0' shape=(64,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv15_upsample/allconv15_upsample_conv/kernel:0' shape=(3, 3, 64, 32) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv15_upsample/allconv15_upsample_conv/bias:0' shape=(32,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv16/kernel:0' shape=(3, 3, 32, 16) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv16/bias:0' shape=(16,) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv17/kernel:0' shape=(3, 3, 16, 3) dtype=float32_ref>, <tf.Variable 'inpaint_net/allconv17/bias:0' shape=(3,) dtype=float32_ref>]
[32m[2019-03-14 21:01:49 @trainer.py:63][0m log_dir: model_logs/20190314210129062103_10-255-0-254_mine_NORMAL_wgan_gp_full_model_celeba_hq_256
[32m[2019-03-14 21:01:49 @trainer.py:63][0m global_step_add_one: Tensor("add_one_to_global_step:0", shape=(), dtype=int32_ref)
[32m[2019-03-14 21:01:49 @trainer.py:64][0m --------------------------------------------------------------------------------
[32m[2019-03-14 21:01:50 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
[32m[2019-03-14 21:01:50 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
[32m[2019-03-14 21:01:50 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
Exception in thread Thread-13:
Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/feeding_queue_runner.py", line 194, in _run
    data = func()
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 143, in <lambda>
    feed_dict_op=[lambda: self.next_batch()],
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 182, in next_batch
    img = cv2.resize(img, tuple(self.shapes[i][:-1][::-1]))
cv2.error: OpenCV(4.0.0) /io/opencv/modules/imgproc/src/resize.cpp:3784: error: (-215:Assertion failed) !ssize.empty() in function 'resize'


Exception in thread Thread-7:
Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/feeding_queue_runner.py", line 194, in _run
    data = func()
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 143, in <lambda>
    feed_dict_op=[lambda: self.next_batch()],
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 182, in next_batch
    img = cv2.resize(img, tuple(self.shapes[i][:-1][::-1]))
cv2.error: OpenCV(4.0.0) /io/opencv/modules/imgproc/src/resize.cpp:3784: error: (-215:Assertion failed) !ssize.empty() in function 'resize'


Exception in thread Thread-12:
Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/feeding_queue_runner.py", line 194, in _run
    data = func()
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 143, in <lambda>
    feed_dict_op=[lambda: self.next_batch()],
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 182, in next_batch
    img = cv2.resize(img, tuple(self.shapes[i][:-1][::-1]))
cv2.error: OpenCV(4.0.0) /io/opencv/modules/imgproc/src/resize.cpp:3784: error: (-215:Assertion failed) !ssize.empty() in function 'resize'


[32m[2019-03-14 21:01:51 @logger.py:43][0m [32;1mTrigger callback: [0mTrigger WeightsViewer: logging model weights...
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv1/kernel:0, shape: [5, 5, 5, 32], size: 4000
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv1/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv2_downsample/kernel:0, shape: [3, 3, 32, 64], size: 18432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv2_downsample/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv3/kernel:0, shape: [3, 3, 64, 64], size: 36864
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv3/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv4_downsample/kernel:0, shape: [3, 3, 64, 128], size: 73728
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv4_downsample/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv5/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv5/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv6/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv6/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv7_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv7_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv8_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv8_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv9_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv9_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv10_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv10_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv11/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv11/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv12/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv12/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv13_upsample/conv13_upsample_conv/kernel:0, shape: [3, 3, 128, 64], size: 73728
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv13_upsample/conv13_upsample_conv/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv14/kernel:0, shape: [3, 3, 64, 64], size: 36864
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv14/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv15_upsample/conv15_upsample_conv/kernel:0, shape: [3, 3, 64, 32], size: 18432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv15_upsample/conv15_upsample_conv/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv16/kernel:0, shape: [3, 3, 32, 16], size: 4608
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv16/bias:0, shape: [16], size: 16
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv17/kernel:0, shape: [3, 3, 16, 3], size: 432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/conv17/bias:0, shape: [3], size: 3
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv1/kernel:0, shape: [5, 5, 5, 32], size: 4000
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv1/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv2_downsample/kernel:0, shape: [3, 3, 32, 32], size: 9216
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv2_downsample/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv3/kernel:0, shape: [3, 3, 32, 64], size: 18432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv3/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv4_downsample/kernel:0, shape: [3, 3, 64, 64], size: 36864
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv4_downsample/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv5/kernel:0, shape: [3, 3, 64, 128], size: 73728
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv5/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv6/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv6/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv7_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv7_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv8_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv8_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv9_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv9_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv10_atrous/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/xconv10_atrous/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv1/kernel:0, shape: [5, 5, 5, 32], size: 4000
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv1/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv2_downsample/kernel:0, shape: [3, 3, 32, 32], size: 9216
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv2_downsample/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv3/kernel:0, shape: [3, 3, 32, 64], size: 18432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv3/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv4_downsample/kernel:0, shape: [3, 3, 64, 128], size: 73728
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv4_downsample/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv5/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv5/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv6/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv6/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv9/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv9/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv10/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/pmconv10/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv11/kernel:0, shape: [3, 3, 256, 128], size: 294912
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv11/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv12/kernel:0, shape: [3, 3, 128, 128], size: 147456
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv12/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv13_upsample/allconv13_upsample_conv/kernel:0, shape: [3, 3, 128, 64], size: 73728
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv13_upsample/allconv13_upsample_conv/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv14/kernel:0, shape: [3, 3, 64, 64], size: 36864
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv14/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv15_upsample/allconv15_upsample_conv/kernel:0, shape: [3, 3, 64, 32], size: 18432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv15_upsample/allconv15_upsample_conv/bias:0, shape: [32], size: 32
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv16/kernel:0, shape: [3, 3, 32, 16], size: 4608
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv16/bias:0, shape: [16], size: 16
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv17/kernel:0, shape: [3, 3, 16, 3], size: 432
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: inpaint_net/allconv17/bias:0, shape: [3], size: 3
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv1/kernel:0, shape: [5, 5, 3, 64], size: 4800
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv1/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv2/kernel:0, shape: [5, 5, 64, 128], size: 204800
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv2/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv3/kernel:0, shape: [5, 5, 128, 256], size: 819200
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv3/bias:0, shape: [256], size: 256
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv4/kernel:0, shape: [5, 5, 256, 512], size: 3276800
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_local/conv4/bias:0, shape: [512], size: 512
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv1/kernel:0, shape: [5, 5, 3, 64], size: 4800
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv1/bias:0, shape: [64], size: 64
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv2/kernel:0, shape: [5, 5, 64, 128], size: 204800
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv2/bias:0, shape: [128], size: 128
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv3/kernel:0, shape: [5, 5, 128, 256], size: 819200
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv3/bias:0, shape: [256], size: 256
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv4/kernel:0, shape: [5, 5, 256, 256], size: 1638400
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/discriminator_global/conv4/bias:0, shape: [256], size: 256
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/dout_local_fc/kernel:0, shape: [32768, 1], size: 32768
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/dout_local_fc/bias:0, shape: [1], size: 1
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/dout_global_fc/kernel:0, shape: [65536, 1], size: 65536
[32m[2019-03-14 21:01:51 @weights_viewer.py:43][0m - weight name: discriminator/dout_global_fc/bias:0, shape: [1], size: 1
[32m[2019-03-14 21:01:51 @logger.py:43][0m [32;1mTrigger callback: [0mTotal counts of trainable weights: 10674312.
[32m[2019-03-14 21:01:51 @weights_viewer.py:60][0m Total size of trainable weights: 0G 10M 184K 136B (Assuming32-bit data type.)
[32m[2019-03-14 21:03:05 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/usr/lib/python3.5/threading.py", line 914, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.5/threading.py", line 862, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/feeding_queue_runner.py", line 194, in _run
    data = func()
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 143, in <lambda>
    feed_dict_op=[lambda: self.next_batch()],
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/data/data_from_fnames.py", line 182, in next_batch
    img = cv2.resize(img, tuple(self.shapes[i][:-1][::-1]))
cv2.error: OpenCV(4.0.0) /io/opencv/modules/imgproc/src/resize.cpp:3784: error: (-215:Assertion failed) !ssize.empty() in function 'resize'


[32m[2019-03-14 21:05:48 @data_from_fnames.py:153][0m image is None, sleep this thread for 0.1s.
  File "train.py", line 39
    else:
        ^
IndentationError: unindent does not match any outer indentation level
Traceback (most recent call last):
  File "train.py", line 6, in <module>
    import tensorflow as tf
ImportError: No module named tensorflow
[32m[2019-03-17 10:59:19 @__init__.py:79][0m Set root logger. Unset logger with neuralgym.unset_logger().
[32m[2019-03-17 10:59:19 @__init__.py:80][0m Saving logging to file: neuralgym_logs/20190317105919676416.
[32m[2019-03-17 10:59:29 @config.py:92][0m ---------------------------------- APP CONFIG ----------------------------------
[32m[2019-03-17 10:59:29 @config.py:119][0m MAX_ITERS: 100000
[32m[2019-03-17 10:59:29 @config.py:119][0m RANDOM_CROP: False
[32m[2019-03-17 10:59:29 @config.py:119][0m IMG_SHAPES: [256, 256, 3]
[32m[2019-03-17 10:59:29 @config.py:119][0m STATIC_VIEW_SIZE: 30
[32m[2019-03-17 10:59:29 @config.py:119][0m FEATURE_LOSS: True
[32m[2019-03-17 10:59:29 @config.py:119][0m VIZ_MAX_OUT: 10
[32m[2019-03-17 10:59:29 @config.py:119][0m MAX_DELTA_HEIGHT: 32
[32m[2019-03-17 10:59:29 @config.py:119][0m GRADS_SUMMARY: False
[32m[2019-03-17 10:59:29 @config.py:119][0m AE_LOSS: True
[32m[2019-03-17 10:59:29 @config.py:119][0m COARSE_L1_ALPHA: 1.2
[32m[2019-03-17 10:59:29 @config.py:119][0m L1_LOSS: True
[32m[2019-03-17 10:59:29 @config.py:119][0m GAN_WITH_MASK: False
[32m[2019-03-17 10:59:29 @config.py:119][0m GRAMS_LOSS_ALPHA: 50
[32m[2019-03-17 10:59:29 @config.py:119][0m LOAD_VGG_MODEL: True
[32m[2019-03-17 10:59:29 @config.py:119][0m TRAIN_SPE: 1000
[32m[2019-03-17 10:59:29 @config.py:119][0m MAX_DELTA_WIDTH: 32
[32m[2019-03-17 10:59:29 @config.py:119][0m HORIZONTAL_MARGIN: 0
[32m[2019-03-17 10:59:29 @config.py:119][0m MODEL_RESTORE: release_imagenet_256
[32m[2019-03-17 10:59:29 @config.py:119][0m LOG_DIR: full_model_celeba_hq_256
[32m[2019-03-17 10:59:29 @config.py:119][0m PADDING: SAME
[32m[2019-03-17 10:59:29 @config.py:111][0m DATA_FLIST: 
[32m[2019-03-17 10:59:29 @config.py:119][0m   celeba: ['data/celeba/train_shuffled.flist', 'data/celeba/validation_static_view.flist']
[32m[2019-03-17 10:59:29 @config.py:119][0m   places2: ['data/places2/train_shuffled.flist', 'data/places2/validation_static_view.flist']
[32m[2019-03-17 10:59:29 @config.py:119][0m   imagenet: ['data/imagenet/train_shuffled.flist', 'data/imagenet/validation_static_view.flist']
[32m[2019-03-17 10:59:29 @config.py:119][0m   celebahq: ['data/celeba_hq/train_shuffled.flist', 'data/celeba_hq/validation_static_view.flist']
[32m[2019-03-17 10:59:29 @config.py:119][0m   mine: ['data_flist/train_shuffled.flist', 'data_flist/validation_shuffled.flist']
[32m[2019-03-17 10:59:29 @config.py:119][0m VAL_PSTEPS: 1000
[32m[2019-03-17 10:59:29 @config.py:119][0m HEIGHT: 128
[32m[2019-03-17 10:59:29 @config.py:119][0m VERTICAL_MARGIN: 0
[32m[2019-03-17 10:59:29 @config.py:119][0m VGG_MODEL_FILE: vgg/vgg16_weights.npz
[32m[2019-03-17 10:59:29 @config.py:119][0m GAN_LOSS_ALPHA: 0.001
[32m[2019-03-17 10:59:29 @config.py:119][0m GPU_ID: 0
[32m[2019-03-17 10:59:29 @config.py:119][0m DISCOUNTED_MASK: True
[32m[2019-03-17 10:59:29 @config.py:119][0m TV_LOSS: False
[32m[2019-03-17 10:59:29 @config.py:119][0m GRADIENT_CLIP_VALUE: 0.1Â Â 
[32m[2019-03-17 10:59:29 @config.py:119][0m GRADIENT_CLIP: False
[32m[2019-03-17 10:59:29 @config.py:119][0m GAN: wgan_gp
[32m[2019-03-17 10:59:29 @config.py:119][0m GLOBAL_DCGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 10:59:29 @config.py:119][0m z: 0.9
[32m[2019-03-17 10:59:29 @config.py:119][0m BATCH_SIZE: 16
[32m[2019-03-17 10:59:29 @config.py:119][0m TV_LOSS_ALPHA: 0.0
[32m[2019-03-17 10:59:29 @config.py:119][0m DATASET: mine
[32m[2019-03-17 10:59:29 @config.py:119][0m VAL: False
[32m[2019-03-17 10:59:29 @config.py:119][0m WIDTH: 128
[32m[2019-03-17 10:59:29 @config.py:119][0m GRAMS_LOSS: True
[32m[2019-03-17 10:59:29 @config.py:119][0m NUM_GPUS: 1
[32m[2019-03-17 10:59:29 @config.py:119][0m AE_LOSS_ALPHA: 1.2
[32m[2019-03-17 10:59:29 @config.py:119][0m FEATURE_LOSS_ALPHA: 0.01
[32m[2019-03-17 10:59:29 @config.py:119][0m L1_LOSS_ALPHA: 1.2
[32m[2019-03-17 10:59:29 @config.py:119][0m GLOBAL_WGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 10:59:29 @config.py:119][0m RANDOM_SEED: False
[32m[2019-03-17 10:59:29 @config.py:119][0m PRETRAIN_COARSE_NETWORK: False
[32m[2019-03-17 10:59:29 @config.py:119][0m WGAN_GP_LAMBDA: 10
[32m[2019-03-17 10:59:29 @config.py:94][0m --------------------------------------------------------------------------------
[32m[2019-03-17 10:59:29 @gpus.py:20][0m Set env: CUDA_VISIBLE_DEVICES=[0].
[32m[2019-03-17 10:59:29 @dataset.py:26][0m --------------------------------- Dataset Info ---------------------------------
[32m[2019-03-17 10:59:29 @dataset.py:36][0m random_crop: False
[32m[2019-03-17 10:59:29 @dataset.py:36][0m random: False
[32m[2019-03-17 10:59:29 @dataset.py:36][0m enqueue_size: 32
[32m[2019-03-17 10:59:29 @dataset.py:36][0m fn_preprocess: None
[32m[2019-03-17 10:59:29 @dataset.py:36][0m filetype: image
[32m[2019-03-17 10:59:29 @dataset.py:36][0m queue_size: 256
[32m[2019-03-17 10:59:29 @dataset.py:36][0m shapes: [[256, 256, 3]]
[32m[2019-03-17 10:59:29 @dataset.py:36][0m nthreads: 16
[32m[2019-03-17 10:59:29 @dataset.py:36][0m return_fnames: False
[32m[2019-03-17 10:59:29 @dataset.py:36][0m file_length: 4420
[32m[2019-03-17 10:59:29 @dataset.py:36][0m dtypes: [tf.float32]
[32m[2019-03-17 10:59:29 @dataset.py:36][0m index: 0
[32m[2019-03-17 10:59:29 @dataset.py:36][0m batch_phs: [<tf.Tensor 'Placeholder:0' shape=(?, 256, 256, 3) dtype=float32>]
[32m[2019-03-17 10:59:29 @dataset.py:37][0m --------------------------------------------------------------------------------
[32m[2019-03-17 10:59:32 @inpaint_model.py:159][0m Set batch_predicted to x2.
Traceback (most recent call last):
  File "train.py", line 52, in <module>
    images, config=config)
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_model.py", line 171, in build_graph_with_losses
    losses['l1_loss'] = l1_alpha * tf.reduce_mean(tf.abs(local_patch_batch_pos - local_patch_x1)*spatial_discounting_mask(config))
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_ops.py", line 198, in spatial_discounting_mask
    gamma = config.SPATIAL_DISCOUNTING_GAMMA
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/utils/config.py", line 97, in __getattr__
    value = self._cfg_dict[name]
KeyError: 'SPATIAL_DISCOUNTING_GAMMA'
[32m[2019-03-17 11:02:10 @__init__.py:79][0m Set root logger. Unset logger with neuralgym.unset_logger().
[32m[2019-03-17 11:02:10 @__init__.py:80][0m Saving logging to file: neuralgym_logs/20190317110210071000.
[32m[2019-03-17 11:02:12 @config.py:92][0m ---------------------------------- APP CONFIG ----------------------------------
[32m[2019-03-17 11:02:12 @config.py:119][0m HEIGHT: 128
[32m[2019-03-17 11:02:12 @config.py:119][0m MAX_DELTA_HEIGHT: 32
[32m[2019-03-17 11:02:12 @config.py:119][0m STATIC_VIEW_SIZE: 30
[32m[2019-03-17 11:02:12 @config.py:111][0m DATA_FLIST: 
[32m[2019-03-17 11:02:12 @config.py:119][0m   mine: ['data_flist/train_shuffled.flist', 'data_flist/validation_shuffled.flist']
[32m[2019-03-17 11:02:12 @config.py:119][0m   imagenet: ['data/imagenet/train_shuffled.flist', 'data/imagenet/validation_static_view.flist']
[32m[2019-03-17 11:02:12 @config.py:119][0m   celeba: ['data/celeba/train_shuffled.flist', 'data/celeba/validation_static_view.flist']
[32m[2019-03-17 11:02:12 @config.py:119][0m   celebahq: ['data/celeba_hq/train_shuffled.flist', 'data/celeba_hq/validation_static_view.flist']
[32m[2019-03-17 11:02:12 @config.py:119][0m   places2: ['data/places2/train_shuffled.flist', 'data/places2/validation_static_view.flist']
[32m[2019-03-17 11:02:12 @config.py:119][0m GAN_WITH_MASK: False
[32m[2019-03-17 11:02:12 @config.py:119][0m GRAMS_LOSS_ALPHA: 50
[32m[2019-03-17 11:02:12 @config.py:119][0m IMG_SHAPES: [256, 256, 3]
[32m[2019-03-17 11:02:12 @config.py:119][0m DATASET: mine
[32m[2019-03-17 11:02:12 @config.py:119][0m L1_LOSS_ALPHA: 1.2
[32m[2019-03-17 11:02:12 @config.py:119][0m MAX_ITERS: 100000
[32m[2019-03-17 11:02:12 @config.py:119][0m FEATURE_LOSS: True
[32m[2019-03-17 11:02:12 @config.py:119][0m VIZ_MAX_OUT: 10
[32m[2019-03-17 11:02:12 @config.py:119][0m AE_LOSS_ALPHA: 1.2
[32m[2019-03-17 11:02:12 @config.py:119][0m TV_LOSS: False
[32m[2019-03-17 11:02:12 @config.py:119][0m GAN_LOSS_ALPHA: 0.001
[32m[2019-03-17 11:02:12 @config.py:119][0m LOG_DIR: full_model_celeba_hq_256
[32m[2019-03-17 11:02:12 @config.py:119][0m COARSE_L1_ALPHA: 1.2
[32m[2019-03-17 11:02:12 @config.py:119][0m GRAMS_LOSS: True
[32m[2019-03-17 11:02:12 @config.py:119][0m DISCOUNTED_MASK: True
[32m[2019-03-17 11:02:12 @config.py:119][0m MODEL_RESTORE: release_imagenet_256
[32m[2019-03-17 11:02:12 @config.py:119][0m VGG_MODEL_FILE: vgg/vgg16_weights.npz
[32m[2019-03-17 11:02:12 @config.py:119][0m HORIZONTAL_MARGIN: 0
[32m[2019-03-17 11:02:12 @config.py:119][0m VAL: False
[32m[2019-03-17 11:02:12 @config.py:119][0m MAX_DELTA_WIDTH: 32
[32m[2019-03-17 11:02:12 @config.py:119][0m AE_LOSS: True
[32m[2019-03-17 11:02:12 @config.py:119][0m VERTICAL_MARGIN: 0
[32m[2019-03-17 11:02:12 @config.py:119][0m BATCH_SIZE: 16
[32m[2019-03-17 11:02:12 @config.py:119][0m GPU_ID: 0
[32m[2019-03-17 11:02:12 @config.py:119][0m GAN: wgan_gp
[32m[2019-03-17 11:02:12 @config.py:119][0m VAL_PSTEPS: 1000
[32m[2019-03-17 11:02:12 @config.py:119][0m NUM_GPUS: 1
[32m[2019-03-17 11:02:12 @config.py:119][0m z: 0.9
[32m[2019-03-17 11:02:12 @config.py:119][0m GLOBAL_WGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 11:02:12 @config.py:119][0m PRETRAIN_COARSE_NETWORK: False
[32m[2019-03-17 11:02:12 @config.py:119][0m RANDOM_SEED: False
[32m[2019-03-17 11:02:12 @config.py:119][0m GLOBAL_DCGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 11:02:12 @config.py:119][0m WIDTH: 128
[32m[2019-03-17 11:02:12 @config.py:119][0m RANDOM_CROP: False
[32m[2019-03-17 11:02:12 @config.py:119][0m LOAD_VGG_MODEL: True
[32m[2019-03-17 11:02:12 @config.py:119][0m TRAIN_SPE: 1000
[32m[2019-03-17 11:02:12 @config.py:119][0m L1_LOSS: True
[32m[2019-03-17 11:02:12 @config.py:119][0m WGAN_GP_LAMBDA: 10
[32m[2019-03-17 11:02:12 @config.py:119][0m GRADIENT_CLIP: False
[32m[2019-03-17 11:02:12 @config.py:119][0m FEATURE_LOSS_ALPHA: 0.01
[32m[2019-03-17 11:02:12 @config.py:119][0m TV_LOSS_ALPHA: 0.0
[32m[2019-03-17 11:02:12 @config.py:119][0m PADDING: SAME
[32m[2019-03-17 11:02:12 @config.py:119][0m GRADS_SUMMARY: False
[32m[2019-03-17 11:02:12 @config.py:119][0m GRADIENT_CLIP_VALUE: 0.1Â Â 
[32m[2019-03-17 11:02:12 @config.py:94][0m --------------------------------------------------------------------------------
[32m[2019-03-17 11:02:12 @gpus.py:20][0m Set env: CUDA_VISIBLE_DEVICES=[0].
[32m[2019-03-17 11:02:12 @dataset.py:26][0m --------------------------------- Dataset Info ---------------------------------
[32m[2019-03-17 11:02:12 @dataset.py:36][0m file_length: 4420
[32m[2019-03-17 11:02:12 @dataset.py:36][0m index: 0
[32m[2019-03-17 11:02:12 @dataset.py:36][0m return_fnames: False
[32m[2019-03-17 11:02:12 @dataset.py:36][0m dtypes: [tf.float32]
[32m[2019-03-17 11:02:12 @dataset.py:36][0m filetype: image
[32m[2019-03-17 11:02:12 @dataset.py:36][0m random: False
[32m[2019-03-17 11:02:12 @dataset.py:36][0m fn_preprocess: None
[32m[2019-03-17 11:02:12 @dataset.py:36][0m nthreads: 16
[32m[2019-03-17 11:02:12 @dataset.py:36][0m shapes: [[256, 256, 3]]
[32m[2019-03-17 11:02:12 @dataset.py:36][0m batch_phs: [<tf.Tensor 'Placeholder:0' shape=(?, 256, 256, 3) dtype=float32>]
[32m[2019-03-17 11:02:12 @dataset.py:36][0m random_crop: False
[32m[2019-03-17 11:02:12 @dataset.py:36][0m enqueue_size: 32
[32m[2019-03-17 11:02:12 @dataset.py:36][0m queue_size: 256
[32m[2019-03-17 11:02:12 @dataset.py:37][0m --------------------------------------------------------------------------------
[32m[2019-03-17 11:02:14 @inpaint_model.py:159][0m Set batch_predicted to x2.
Traceback (most recent call last):
  File "train.py", line 52, in <module>
    images, config=config)
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_model.py", line 171, in build_graph_with_losses
    losses['l1_loss'] = l1_alpha * tf.reduce_mean(tf.abs(local_patch_batch_pos - local_patch_x1)*spatial_discounting_mask(config))
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_ops.py", line 198, in spatial_discounting_mask
    gamma = config.SPATIAL_DISCOUNTING_GAMMA
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/utils/config.py", line 97, in __getattr__
    value = self._cfg_dict[name]
KeyError: 'SPATIAL_DISCOUNTING_GAMMA'
[32m[2019-03-17 11:03:03 @__init__.py:79][0m Set root logger. Unset logger with neuralgym.unset_logger().
[32m[2019-03-17 11:03:03 @__init__.py:80][0m Saving logging to file: neuralgym_logs/20190317110303883359.
[32m[2019-03-17 11:03:06 @config.py:92][0m ---------------------------------- APP CONFIG ----------------------------------
[32m[2019-03-17 11:03:06 @config.py:119][0m MAX_DELTA_WIDTH: 32
[32m[2019-03-17 11:03:06 @config.py:119][0m GLOBAL_WGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 11:03:06 @config.py:119][0m VERTICAL_MARGIN: 0
[32m[2019-03-17 11:03:06 @config.py:119][0m VGG_MODEL_FILE: vgg/vgg16_weights.npz
[32m[2019-03-17 11:03:06 @config.py:119][0m GRADIENT_CLIP: False
[32m[2019-03-17 11:03:06 @config.py:119][0m DATASET: mine
[32m[2019-03-17 11:03:06 @config.py:119][0m WIDTH: 128
[32m[2019-03-17 11:03:06 @config.py:119][0m PADDING: SAME
[32m[2019-03-17 11:03:06 @config.py:119][0m GAN: wgan_gp
[32m[2019-03-17 11:03:06 @config.py:119][0m AE_LOSS: True
[32m[2019-03-17 11:03:06 @config.py:119][0m VIZ_MAX_OUT: 10
[32m[2019-03-17 11:03:06 @config.py:119][0m GRAMS_LOSS_ALPHA: 50
[32m[2019-03-17 11:03:06 @config.py:119][0m HEIGHT: 128
[32m[2019-03-17 11:03:06 @config.py:119][0m AE_LOSS_ALPHA: 1.2
[32m[2019-03-17 11:03:06 @config.py:119][0m MAX_DELTA_HEIGHT: 32
[32m[2019-03-17 11:03:06 @config.py:119][0m TV_LOSS_ALPHA: 0.0
[32m[2019-03-17 11:03:06 @config.py:119][0m MAX_ITERS: 100000
[32m[2019-03-17 11:03:06 @config.py:119][0m RANDOM_CROP: False
[32m[2019-03-17 11:03:06 @config.py:119][0m GRAMS_LOSS: True
[32m[2019-03-17 11:03:06 @config.py:119][0m GRADS_SUMMARY: False
[32m[2019-03-17 11:03:06 @config.py:119][0m FEATURE_LOSS: True
[32m[2019-03-17 11:03:06 @config.py:119][0m NUM_GPUS: 1
[32m[2019-03-17 11:03:06 @config.py:119][0m MODEL_RESTORE: release_imagenet_256
[32m[2019-03-17 11:03:06 @config.py:119][0m VAL_PSTEPS: 1000
[32m[2019-03-17 11:03:06 @config.py:119][0m COARSE_L1_ALPHA: 1.2
[32m[2019-03-17 11:03:06 @config.py:119][0m RANDOM_SEED: False
[32m[2019-03-17 11:03:06 @config.py:119][0m WGAN_GP_LAMBDA: 10
[32m[2019-03-17 11:03:06 @config.py:119][0m DISCOUNTED_MASK: True
[32m[2019-03-17 11:03:06 @config.py:119][0m VAL: False
[32m[2019-03-17 11:03:06 @config.py:119][0m GAN_WITH_MASK: False
[32m[2019-03-17 11:03:06 @config.py:119][0m TV_LOSS: False
[32m[2019-03-17 11:03:06 @config.py:119][0m L1_LOSS_ALPHA: 1.2
[32m[2019-03-17 11:03:06 @config.py:119][0m GAN_LOSS_ALPHA: 0.001
[32m[2019-03-17 11:03:06 @config.py:119][0m IMG_SHAPES: [256, 256, 3]
[32m[2019-03-17 11:03:06 @config.py:119][0m PRETRAIN_COARSE_NETWORK: False
[32m[2019-03-17 11:03:06 @config.py:119][0m z: 0.9
[32m[2019-03-17 11:03:06 @config.py:119][0m TRAIN_SPE: 1000
[32m[2019-03-17 11:03:06 @config.py:119][0m HORIZONTAL_MARGIN: 0
[32m[2019-03-17 11:03:06 @config.py:119][0m FEATURE_LOSS_ALPHA: 0.01
[32m[2019-03-17 11:03:06 @config.py:119][0m L1_LOSS: True
[32m[2019-03-17 11:03:06 @config.py:119][0m GRADIENT_CLIP_VALUE: 0.1Â Â 
[32m[2019-03-17 11:03:06 @config.py:119][0m LOG_DIR: full_model_celeba_hq_256
[32m[2019-03-17 11:03:06 @config.py:119][0m BATCH_SIZE: 16
[32m[2019-03-17 11:03:06 @config.py:119][0m GLOBAL_DCGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 11:03:06 @config.py:111][0m DATA_FLIST: 
[32m[2019-03-17 11:03:06 @config.py:119][0m   celeba: ['data/celeba/train_shuffled.flist', 'data/celeba/validation_static_view.flist']
[32m[2019-03-17 11:03:06 @config.py:119][0m   places2: ['data/places2/train_shuffled.flist', 'data/places2/validation_static_view.flist']
[32m[2019-03-17 11:03:06 @config.py:119][0m   mine: ['data_flist/train_shuffled.flist', 'data_flist/validation_shuffled.flist']
[32m[2019-03-17 11:03:06 @config.py:119][0m   imagenet: ['data/imagenet/train_shuffled.flist', 'data/imagenet/validation_static_view.flist']
[32m[2019-03-17 11:03:06 @config.py:119][0m   celebahq: ['data/celeba_hq/train_shuffled.flist', 'data/celeba_hq/validation_static_view.flist']
[32m[2019-03-17 11:03:06 @config.py:119][0m GPU_ID: 0
[32m[2019-03-17 11:03:06 @config.py:119][0m STATIC_VIEW_SIZE: 30
[32m[2019-03-17 11:03:06 @config.py:119][0m LOAD_VGG_MODEL: True
[32m[2019-03-17 11:03:06 @config.py:94][0m --------------------------------------------------------------------------------
[32m[2019-03-17 11:03:06 @gpus.py:20][0m Set env: CUDA_VISIBLE_DEVICES=[0].
[32m[2019-03-17 11:03:06 @dataset.py:26][0m --------------------------------- Dataset Info ---------------------------------
[32m[2019-03-17 11:03:06 @dataset.py:36][0m dtypes: [tf.float32]
[32m[2019-03-17 11:03:06 @dataset.py:36][0m fn_preprocess: None
[32m[2019-03-17 11:03:06 @dataset.py:36][0m batch_phs: [<tf.Tensor 'Placeholder:0' shape=(?, 256, 256, 3) dtype=float32>]
[32m[2019-03-17 11:03:06 @dataset.py:36][0m queue_size: 256
[32m[2019-03-17 11:03:06 @dataset.py:36][0m filetype: image
[32m[2019-03-17 11:03:06 @dataset.py:36][0m index: 0
[32m[2019-03-17 11:03:06 @dataset.py:36][0m shapes: [[256, 256, 3]]
[32m[2019-03-17 11:03:06 @dataset.py:36][0m return_fnames: False
[32m[2019-03-17 11:03:06 @dataset.py:36][0m random: False
[32m[2019-03-17 11:03:06 @dataset.py:36][0m nthreads: 16
[32m[2019-03-17 11:03:06 @dataset.py:36][0m random_crop: False
[32m[2019-03-17 11:03:06 @dataset.py:36][0m file_length: 4420
[32m[2019-03-17 11:03:06 @dataset.py:36][0m enqueue_size: 32
[32m[2019-03-17 11:03:06 @dataset.py:37][0m --------------------------------------------------------------------------------
[32m[2019-03-17 11:03:08 @inpaint_model.py:159][0m Set batch_predicted to x2.
Traceback (most recent call last):
  File "train.py", line 52, in <module>
    images, config=config)
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_model.py", line 171, in build_graph_with_losses
    losses['l1_loss'] = l1_alpha * tf.reduce_mean(tf.abs(local_patch_batch_pos - local_patch_x1)*spatial_discounting_mask(config))
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_ops.py", line 198, in spatial_discounting_mask
    gamma = config.SPATIAL_DISCOUNTING_GAMMA
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/utils/config.py", line 97, in __getattr__
    value = self._cfg_dict[name]
KeyError: 'SPATIAL_DISCOUNTING_GAMMA'
[32m[2019-03-17 11:04:50 @__init__.py:79][0m Set root logger. Unset logger with neuralgym.unset_logger().
[32m[2019-03-17 11:04:50 @__init__.py:80][0m Saving logging to file: neuralgym_logs/20190317110450561673.
[32m[2019-03-17 11:04:53 @config.py:92][0m ---------------------------------- APP CONFIG ----------------------------------
[32m[2019-03-17 11:04:53 @config.py:119][0m GRADS_SUMMARY: False
[32m[2019-03-17 11:04:53 @config.py:119][0m L1_LOSS_ALPHA: 1.2
[32m[2019-03-17 11:04:53 @config.py:119][0m HEIGHT: 128
[32m[2019-03-17 11:04:53 @config.py:119][0m z: 0.9
[32m[2019-03-17 11:04:53 @config.py:119][0m NUM_GPUS: 1
[32m[2019-03-17 11:04:53 @config.py:111][0m DATA_FLIST: 
[32m[2019-03-17 11:04:53 @config.py:119][0m   celebahq: ['data/celeba_hq/train_shuffled.flist', 'data/celeba_hq/validation_static_view.flist']
[32m[2019-03-17 11:04:53 @config.py:119][0m   celeba: ['data/celeba/train_shuffled.flist', 'data/celeba/validation_static_view.flist']
[32m[2019-03-17 11:04:53 @config.py:119][0m   imagenet: ['data/imagenet/train_shuffled.flist', 'data/imagenet/validation_static_view.flist']
[32m[2019-03-17 11:04:53 @config.py:119][0m   mine: ['data_flist/train_shuffled.flist', 'data_flist/validation_shuffled.flist']
[32m[2019-03-17 11:04:53 @config.py:119][0m   places2: ['data/places2/train_shuffled.flist', 'data/places2/validation_static_view.flist']
[32m[2019-03-17 11:04:53 @config.py:119][0m VAL: False
[32m[2019-03-17 11:04:53 @config.py:119][0m MAX_DELTA_HEIGHT: 32
[32m[2019-03-17 11:04:53 @config.py:119][0m RANDOM_CROP: False
[32m[2019-03-17 11:04:53 @config.py:119][0m VGG_MODEL_FILE: vgg/vgg16_weights.npz
[32m[2019-03-17 11:04:53 @config.py:119][0m COARSE_L1_ALPHA: 1.2
[32m[2019-03-17 11:04:53 @config.py:119][0m IMG_SHAPES: [256, 256, 3]
[32m[2019-03-17 11:04:53 @config.py:119][0m VERTICAL_MARGIN: 0
[32m[2019-03-17 11:04:53 @config.py:119][0m WGAN_GP_LAMBDA: 10
[32m[2019-03-17 11:04:53 @config.py:119][0m MAX_DELTA_WIDTH: 32
[32m[2019-03-17 11:04:53 @config.py:119][0m GAN_WITH_MASK: False
[32m[2019-03-17 11:04:53 @config.py:119][0m MODEL_RESTORE: release_imagenet_256
[32m[2019-03-17 11:04:53 @config.py:119][0m GLOBAL_WGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 11:04:53 @config.py:119][0m VIZ_MAX_OUT: 10
[32m[2019-03-17 11:04:53 @config.py:119][0m LOG_DIR: full_model_celeba_hq_256
[32m[2019-03-17 11:04:53 @config.py:119][0m WIDTH: 128
[32m[2019-03-17 11:04:53 @config.py:119][0m GAN_LOSS_ALPHA: 0.001
[32m[2019-03-17 11:04:53 @config.py:119][0m AE_LOSS_ALPHA: 1.2
[32m[2019-03-17 11:04:53 @config.py:119][0m GRADIENT_CLIP_VALUE: 0.1Â Â 
[32m[2019-03-17 11:04:53 @config.py:119][0m GRAMS_LOSS_ALPHA: 50
[32m[2019-03-17 11:04:53 @config.py:119][0m GPU_ID: 0
[32m[2019-03-17 11:04:53 @config.py:119][0m LOAD_VGG_MODEL: True
[32m[2019-03-17 11:04:53 @config.py:119][0m GAN: wgan_gp
[32m[2019-03-17 11:04:53 @config.py:119][0m L1_LOSS: True
[32m[2019-03-17 11:04:53 @config.py:119][0m GRAMS_LOSS: True
[32m[2019-03-17 11:04:53 @config.py:119][0m RANDOM_SEED: False
[32m[2019-03-17 11:04:53 @config.py:119][0m AE_LOSS: True
[32m[2019-03-17 11:04:53 @config.py:119][0m FEATURE_LOSS_ALPHA: 0.01
[32m[2019-03-17 11:04:53 @config.py:119][0m TV_LOSS_ALPHA: 0.0
[32m[2019-03-17 11:04:53 @config.py:119][0m DATASET: mine
[32m[2019-03-17 11:04:53 @config.py:119][0m DISCOUNTED_MASK: True
[32m[2019-03-17 11:04:53 @config.py:119][0m FEATURE_LOSS: True
[32m[2019-03-17 11:04:53 @config.py:119][0m MAX_ITERS: 100000
[32m[2019-03-17 11:04:53 @config.py:119][0m TV_LOSS: False
[32m[2019-03-17 11:04:53 @config.py:119][0m TRAIN_SPE: 1000
[32m[2019-03-17 11:04:53 @config.py:119][0m PRETRAIN_COARSE_NETWORK: False
[32m[2019-03-17 11:04:53 @config.py:119][0m VAL_PSTEPS: 1000
[32m[2019-03-17 11:04:53 @config.py:119][0m GLOBAL_DCGAN_LOSS_ALPHA: 1.0
[32m[2019-03-17 11:04:53 @config.py:119][0m BATCH_SIZE: 16
[32m[2019-03-17 11:04:53 @config.py:119][0m STATIC_VIEW_SIZE: 30
[32m[2019-03-17 11:04:53 @config.py:119][0m HORIZONTAL_MARGIN: 0
[32m[2019-03-17 11:04:53 @config.py:119][0m GRADIENT_CLIP: False
[32m[2019-03-17 11:04:53 @config.py:119][0m PADDING: SAME
[32m[2019-03-17 11:04:53 @config.py:94][0m --------------------------------------------------------------------------------
[32m[2019-03-17 11:04:53 @gpus.py:20][0m Set env: CUDA_VISIBLE_DEVICES=[0].
[32m[2019-03-17 11:04:53 @dataset.py:26][0m --------------------------------- Dataset Info ---------------------------------
[32m[2019-03-17 11:04:53 @dataset.py:36][0m filetype: image
[32m[2019-03-17 11:04:53 @dataset.py:36][0m random: False
[32m[2019-03-17 11:04:53 @dataset.py:36][0m file_length: 4420
[32m[2019-03-17 11:04:53 @dataset.py:36][0m fn_preprocess: None
[32m[2019-03-17 11:04:53 @dataset.py:36][0m batch_phs: [<tf.Tensor 'Placeholder:0' shape=(?, 256, 256, 3) dtype=float32>]
[32m[2019-03-17 11:04:53 @dataset.py:36][0m random_crop: False
[32m[2019-03-17 11:04:53 @dataset.py:36][0m queue_size: 256
[32m[2019-03-17 11:04:53 @dataset.py:36][0m nthreads: 16
[32m[2019-03-17 11:04:53 @dataset.py:36][0m enqueue_size: 32
[32m[2019-03-17 11:04:53 @dataset.py:36][0m return_fnames: False
[32m[2019-03-17 11:04:53 @dataset.py:36][0m index: 0
[32m[2019-03-17 11:04:53 @dataset.py:36][0m dtypes: [tf.float32]
[32m[2019-03-17 11:04:53 @dataset.py:36][0m shapes: [[256, 256, 3]]
[32m[2019-03-17 11:04:53 @dataset.py:37][0m --------------------------------------------------------------------------------
[32m[2019-03-17 11:04:55 @inpaint_model.py:159][0m Set batch_predicted to x2.
Traceback (most recent call last):
  File "train.py", line 52, in <module>
    images, config=config)
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_model.py", line 171, in build_graph_with_losses
    losses['l1_loss'] = l1_alpha * tf.reduce_mean(tf.abs(local_patch_batch_pos - local_patch_x1)*spatial_discounting_mask(config))
  File "/home/dc2-user/siuDong/ganCode/generative_inpainting/inpaint_ops.py", line 198, in spatial_discounting_mask
    gamma = config.SPATIAL_DISCOUNTING_GAMMA
  File "/usr/local/lib/python3.5/dist-packages/neuralgym/utils/config.py", line 97, in __getattr__
    value = self._cfg_dict[name]
KeyError: 'SPATIAL_DISCOUNTING_GAMMA'
